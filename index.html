<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Map Dash</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin="" />
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin=""></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        #map {
            height: 100%;
            width: 100%;
            border-radius: 0.5rem;
            position: relative; /* Needed for positioning child elements */
        }
        .leaflet-popup-content-wrapper {
            background-color: #1f2937;
            color: #f3f4f6;
            border-radius: 0.5rem;
        }
        .leaflet-popup-content {
            margin: 1rem;
        }
        .leaflet-popup-tip {
            background: #1f2937;
        }
        .leaflet-control-zoom-in, .leaflet-control-zoom-out {
            background-color: #1f2937 !important;
            color: #f3f4f6 !important;
            border-radius: 0.25rem !important;
        }
        .dashboard-btn.active {
            background-color: #2563eb; /* A nice blue for active state */
            box-shadow: 0 0 15px rgba(59, 130, 246, 0.5);
        }
    </style>
</head>
<body class="bg-gray-900 text-gray-100">

    <!-- Header -->
    <header class="bg-gray-800 shadow-lg">
        <div class="container mx-auto px-4 py-4 flex items-center justify-between">
            <a href="#" class="text-2xl font-bold text-white flex items-center">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                  <path stroke-linecap="round" stroke-linejoin="round" d="M3.055 11H5a2 2 0 012 2v1a2 2 0 002 2h1a2 2 0 002-2v-1a2 2 0 012-2h1.945M7.884 4.036A9 9 0 1016.116 4.036m-8.232 0a9 9 0 018.232 0" />
                </svg>
                Map Dash
            </a>
        </div>
    </header>

    <!-- Main Content -->
    <main class="container mx-auto p-4">
        <div class="flex flex-col md:flex-row gap-4">

            <!-- Control Panel -->
            <div class="w-full md:w-1/3 bg-gray-800 p-4 rounded-lg shadow-lg">
                <div class="flex justify-between items-center mb-4">
                    <h2 class="text-xl font-bold">Dashboards</h2>
                    <button id="get-location-btn" class="bg-gray-700 hover:bg-blue-600 text-white font-bold py-2 px-3 rounded-lg flex items-center text-sm transition-colors duration-300">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M5.05 4.05a7 7 0 119.9 9.9L10 18.9l-4.95-4.95a7 7 0 010-9.9zM10 11a2 2 0 100-4 2 2 0 000 4z" clip-rule="evenodd" /></svg>
                        My Location
                    </button>
                </div>
                <div id="dashboard-options" class="space-y-3">
                    <button data-dashboard="weather" class="dashboard-btn w-full bg-gray-700 hover:bg-gray-600 text-white font-bold py-3 px-4 rounded-lg flex items-center transition duration-300">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 mr-3" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M3 15a4 4 0 004 4h9a5 5 0 10-.1-9.999 5.002 5.002 0 10-9.78 2.096A4.001 4.001 0 003 15z" /></svg>
                        Real-Time Weather
                    </button>
                    <button data-dashboard="satellite" class="dashboard-btn w-full bg-gray-700 hover:bg-gray-600 text-white font-bold py-3 px-4 rounded-lg flex items-center transition duration-300">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 mr-3" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M5 12.552A6.002 6.002 0 0112 6.552a6.002 6.002 0 016.948 6M5 12.552v-3.004A6.002 6.002 0 0112 3.548a6.002 6.002 0 016.948 6.004v3.004M7.524 18.024A6.002 6.002 0 0112 12.024a6.002 6.002 0 014.476 6" /></svg>
                        Satellite Explorer
                    </button>
                    <button data-dashboard="aqi" class="dashboard-btn w-full bg-gray-700 hover:bg-gray-600 text-white font-bold py-3 px-4 rounded-lg flex items-center transition duration-300">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 mr-3" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M17.657 18.657A8 8 0 016.343 7.343S7 9 9 10c0-2 .5-5 2.986-7C14 5 15.5 8 15.5 9c1.5-1 2.157-1.343 2.157-1.343a8 8 0 010 11z" /></svg>
                        Air Quality (AQI)
                    </button>
                    <button data-dashboard="storm" class="dashboard-btn w-full bg-gray-700 hover:bg-gray-600 text-white font-bold py-3 px-4 rounded-lg flex items-center transition duration-300">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 mr-3" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M13 10V3L4 14h7v7l9-11h-7z" /></svg>
                        Storm Tracker
                    </button>
                </div>
            </div>

            <!-- Map -->
            <div class="w-full md:w-2/3 h-[80vh] bg-gray-800 rounded-lg shadow-lg">
                <div id="map"></div>
            </div>
        </div>
    </main>

    <!-- Footer -->
    <footer class="bg-gray-800 mt-4">
        <div class="container mx-auto px-4 py-4 text-center text-gray-400">
            <p>&copy; 2025 Map Dash. All Rights Reserved.</p>
        </div>
    </footer>

    <script>
        // --- MAP INITIALIZATION ---
        const map = L.map('map').setView([40.7128, -74.0060], 5); // Default to NYC, zoomed out a bit

        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
        }).addTo(map);

        // --- UI ELEMENTS ---
        const getLocationBtn = document.getElementById('get-location-btn');
        const dashboardButtons = document.querySelectorAll('.dashboard-btn');
        let userLocationMarker = null;

        // --- INFO BOX on MAP ---
        const mapInfoBox = document.createElement('div');
        mapInfoBox.style.position = 'absolute';
        mapInfoBox.style.bottom = '10px';
        mapInfoBox.style.left = '10px';
        mapInfoBox.style.zIndex = 1000;
        mapInfoBox.style.backgroundColor = 'rgba(31, 41, 55, 0.85)';
        mapInfoBox.style.color = 'white';
        mapInfoBox.style.padding = '10px 15px';
        mapInfoBox.style.borderRadius = '8px';
        mapInfoBox.style.maxWidth = '300px';
        mapInfoBox.style.boxShadow = '0 4px 12px rgba(0,0,0,0.4)';
        mapInfoBox.innerHTML = '<h3 class="font-bold text-lg">Welcome to Map Dash</h3><p class="text-gray-300 text-sm">Select a dashboard from the left to begin.</p>';
        document.getElementById('map').appendChild(mapInfoBox);


        // --- EVENT LISTENERS ---
        getLocationBtn.addEventListener('click', () => {
            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(position => {
                    const { latitude, longitude } = position.coords;
                    const userLocation = L.latLng(latitude, longitude);
                    map.setView(userLocation, 13);
                    
                    // Remove old marker if it exists
                    if (userLocationMarker) {
                        map.removeLayer(userLocationMarker);
                    }
                    
                    // Add a new marker for user location
                    userLocationMarker = L.marker(userLocation, {
                        icon: L.divIcon({
                            html: `<div class="w-4 h-4 bg-red-500 rounded-full border-2 border-white animate-pulse"></div>`,
                            className: 'user-location-icon',
                            iconSize: [16, 16]
                        })
                    }).addTo(map).bindPopup("You are here").openPopup();

                }, () => {
                    alert('Could not get your location. Please enable location services.');
                });
            } else {
                alert('Geolocation is not supported by this browser.');
            }
        });

        dashboardButtons.forEach(button => {
            button.addEventListener('click', () => {
                const dashboardType = button.dataset.dashboard;
                
                // Update button styles to show active state
                dashboardButtons.forEach(btn => btn.classList.remove('active'));
                button.classList.add('active');

                let title = '';
                let description = 'Functionality for this dashboard is coming soon!';

                switch(dashboardType) {
                    case 'weather':
                        title = 'Real-Time Weather';
                        break;
                    case 'satellite':
                        title = 'Satellite Explorer';
                        break;
                    case 'aqi':
                        title = 'Air Quality (AQI)';
                        break;
                    case 'storm':
                        title = 'Storm Tracker';
                        break;
                }
                
                // Update the info box on the map
                mapInfoBox.innerHTML = `<h3 class="font-bold text-lg">${title}</h3><p class="text-gray-300 text-sm">${description}</p>`;
            });
        });

    </script>
</body>
</html>
